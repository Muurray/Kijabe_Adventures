/* * Blog loader — consolidated + share buttons * - Loads posts from ../data/blogs.json * - Search, pagination * - Renders "more articles" (latest 3) * - Adds per-article share buttons (FB, WhatsApp, copy link) */let postsData = [];let currentPage = 1;const postsPerPage = 6;const container = document.getElementById("blog-container");const searchInput = document.getElementById("blog-search");const paginationEl = document.getElementById("pagination");// Helper: create share buttons HTML for a given URL + titlefunction createShareButtons(url, title) {  const encodedUrl = encodeURIComponent(url);  const encodedTitle = encodeURIComponent(title || document.title);  return `    <div class="share-actions">      <a class="share-btn share-fb" href="https://www.facebook.com/sharer/sharer.php?u=${encodedUrl}" target="_blank" rel="noopener">Share</a>      <a class="share-btn share-wa" href="https://wa.me/?text=${encodedTitle}%20${encodedUrl}" target="_blank" rel="noopener">WhatsApp</a>      <button class="share-btn share-copy" type="button" onclick="copyURLTo('${encodedUrl}')">Copy Link</button>    </div>  `;}// Copy helper (global so onclick in generated HTML can call it)window.copyURLTo = function(encodedUrl) {  try {    const url = decodeURIComponent(encodedUrl);    navigator.clipboard.writeText(url).then(() => {      alert('Link copied!');    }, () => {      prompt('Copy this link', url);    });  } catch (e) {    console.error('Copy failed', e);  }};// Load posts into memory and renderasync function loadBlogs() {  try {    const res = await fetch('../data/blogs.json');    if (!res.ok) throw new Error('Failed to load blog posts');    postsData = await res.json();    postsData.sort((a, b) => new Date(b.date) - new Date(a.date));    renderPosts();    setupPagination();    loadMoreArticles();  } catch (err) {    console.error(err);    if (container) container.innerHTML = '<div class="error-message">Could not load blogs.</div>';  }}function applySearch(posts) {  const term = (searchInput && searchInput.value || '').toLowerCase();  if (!term) return posts;  return posts.filter(p => (p.title || '').toLowerCase().includes(term) || (p.excerpt || '').toLowerCase().includes(term));}function renderPosts() {  if (!container) return;  container.innerHTML = '';  const filtered = applySearch(postsData);  const start = (currentPage - 1) * postsPerPage;  const visible = filtered.slice(start, start + postsPerPage);  if (visible.length === 0) {    container.innerHTML = '<p>No blog posts found.</p>';    return;  }  visible.forEach(post => {    const dateFormatted = new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });    const postUrl = 'blog-post.html?id=' + encodeURIComponent(post.id);    container.innerHTML += `      <div class="blog-card">        <div class="blog-card-image"><img src="${post.image}" alt="${post.title}" loading="lazy"></div>        <div class="blog-card-content">          <span class="blog-date">${dateFormatted}</span>          <h3>${post.title}</h3>          <p class="blog-excerpt">${post.excerpt}</p>          <a href="${postUrl}" class="read-more">Read More →</a>          ${createShareButtons(postUrl, post.title)}        </div>      </div>    `;  });}// Search bindingif (searchInput) {  searchInput.addEventListener('input', () => {    currentPage = 1;    renderPosts();    setupPagination();  });}function setupPagination() {  if (!paginationEl) return;  const filtered = applySearch(postsData);  const totalPages = Math.max(1, Math.ceil(filtered.length / postsPerPage));  paginationEl.innerHTML = `    <button ${currentPage === 1 ? 'disabled' : ''} id="prevBtn">Prev</button>    <span>Page ${currentPage} of ${totalPages}</span>    <button ${currentPage === totalPages ? 'disabled' : ''} id="nextBtn">Next</button>  `;  const prev = document.getElementById('prevBtn');  const next = document.getElementById('nextBtn');  if (prev) prev.onclick = () => { if (currentPage>1) { currentPage--; renderPosts(); setupPagination(); } };  if (next) next.onclick = () => { if (currentPage<totalPages) { currentPage++; renderPosts(); setupPagination(); } };}// More articles (latest 3)async function loadMoreArticles() {  try {    const moreContainer = document.getElementById('more-articles-json');    if (!moreContainer) return;    const latestThree = (postsData.slice(0)).slice(0, 3);    moreContainer.innerHTML = '';    latestThree.forEach(post => {      const formatted = new Date(post.date).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' });      const postUrl = 'blog-post.html?id=' + encodeURIComponent(post.id);      moreContainer.innerHTML += `        <div class="more-article-card">          <img src="${post.image}" alt="${post.title}">          <span class="blog-date">${formatted}</span>          <h4>${post.title}</h4>          <p>${post.excerpt}</p>          <a href="${postUrl}" class="read-more">Read More →</a>          ${createShareButtons(postUrl, post.title)}        </div>      `;    });  } catch (err) {    console.error('More Articles Error:', err);  }}// StartloadBlogs();